{% extends "layout.html" %}

{% block content %}
<div class="container my-5">
    <h1 class="text-left mb-4">All Courses</h1>

    <!-- Search Bar -->
    <form method="GET" action="{{ url_for('course_list') }}" class="mb-4">
        <div class="input-group">
            <input type="text" name="search" class="form-control" placeholder="Search for courses..." value="{{ request.args.get('search', '') }}">
            <button class="btn btn-primary" type="submit">Search</button>
        </div>
    </form>

    <table class="table table-striped table-bordered" style="width:100%; overflow-x:auto; overflow-y:auto;">
        <thead>
            <tr>
                <th>Course Title</th>
                <th>District</th>
                <th>Location</th>
                <th>Course Duration</th>
                <th>Session Times</th>
                <th>No. of Sessions</th>
                <th>Link</th>
            </tr>
        </thead>
        <tbody>
            {% for course in courses %}
                {% if course['ortetermine'] and course['ortetermine']['adresse'] and course['ortetermine']['termin'] %}
                    {% if course['ortetermine']['adresse']|length > 0 and course['ortetermine']['termin']|length > 0 %}
                        <tr>
                            <td>{{ course['name'] }}</td>
                            <td>{{ course['bezirk'] }}</td>
                            <td>
                                {% if course['ortetermine']['adresse'][0] %}
                                    {{ course['ortetermine']['adresse'][0]['strasse'] }},
                                    {{ course['ortetermine']['adresse'][0]['plz'] }} {{ course['ortetermine']['adresse'][0]['ort'] }}
                                {% else %}
                                    Not Available
                                {% endif %}
                            </td>
                            <td>
                                {{ course['beginn_datum'] }} to {{ course['ende_datum'] }}
                            </td>
                            <td>
                                {% if course['ortetermine']['termin'][0] %}
                                    {{ course['ortetermine']['termin'][0]['beginn_uhrzeit'] }} to {{ course['ortetermine']['termin'][0]['ende_uhrzeit'] }}
                                {% else %}
                                    Not Available
                                {% endif %}
                            </td>
                            <td>{{ course['anzahl_termine'] }}</td>
                            <td>
                                {% if course['webadresse'] and course['webadresse']['uri'] %}
                                    <a href="{{ course['webadresse']['uri'] }}">Book Course</a>
                                {% else %}
                                    Not Available
                                {% endif %}
                            </td>
                        </tr>
                    {% else %}
                        <tr><td colspan="7">No sessions or locations available for this course.</td></tr>
                    {% endif %}
                {% else %}
                    <tr><td colspan="7">No sessions or locations available for this course.</td></tr>
                {% endif %}
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
